このツールは、RedMine をターミナルベースで効率よく扱うためのツールである。
チケットの作成・編集を手元の環境で使い慣れたエディタで編集することで情報共有を促進する。
RedMine に固有の機能以外に、自前に以下の機能を提供する。

* ローカルチケット: 個人のタスク管理の観点から、RedMine にアップロードしないタスクを同じ枠組みで管理できると便利である。ローカルチケットは実際に RedMine にアップロードは行わないが、タスクリストやクロック管理の観点で RedMine のチケットと同等の扱いができるため、サマリの生成や統計処理の質が向上する。またオフラインでの作業でも利用できる点や、必要に応じて RedMine チケットに切り替えることもできる点も有益である。
* クロック管理: 特定のタスクにどのくらい時間を費やしたか記録することは、タスク管理や可視化・効率化の観点で重要であるが、一般に手動で記録することは難しい。本ツールでは、あるチケットのデータをエディタで開いて編集している期間をそのチケットに対して作業している期間と定義することで、タスクの作業期間を自動的に記録し続けることが可能としている。
* 設定一式 (設定ファイル) を切り替えることで、複数の RedMine にまたがって作業する場合にもある程度の利便性を確保することができる。

## 事前準備/初回設定

* `jq` と `gawk` をインストールする。
* 対象となる RedMine 上の URL と API key を確認する。
* bash 形式の設定ファイル (`environment` を参考に) に環境変数をセットして source しておく。
* `~/.bashrc` から `redmine.bash` を source する。
* 初回設定時は `redmine config --update` で対象 RedMine サーバ固有の情報を取得する。

上記準備が完了すれば、チケットの一覧 (list)・閲覧 (show)・作成 (new)・編集 (edit) などの通常の操作を実行できる。

## サブコマンド・使い方

### config

チケットにはプロジェクトやステータス、トラッカーなどの概念があるが、名前と ID は RedMine の設定に依存するので、初回利用時やサーバ側で変更 (プロジェクトやトラッカーを追加・更新した場合など) があった時にローカルにそれらの定義済み情報をコピーする必要がある。`redmine config --update` によりダウンロードを実行する。ダウンロードした各種情報は `redmine config <type>` により表示できる。

### new

チケットを作成する。

### list

チケットのリストを更新時刻の昇順で表示する。
~~~
$ redmine list
...
255  190621_1601        Project A           New                   Task A-1
229  190621_1638        Project B           In Progress           Task B-1
264  190621_1827        Project C           In Progress           Task C-1
L7   190621_2223        Project B           Closed                Task B-2
~~~
左からチケット ID、最終更新時刻、プロジェクト、チケット状態、チケットのサブジェクトである。
操作したいチケットを検索・確認するために使用する。

### show

指定したチケット番号の draft を表示する。

### edit

指定したチケット番号の draft を表示・編集する。編集後、更新内容がある場合に RedMine サーバへのアップロードを実行する。

### clock

redmine new/edit でチケットを編集している間、開始時間と終了時間を記録しているので、そこからクロック (その作業に費やした時間) を計算できる。
クロックは基本的に開始から終了までの時間だが、他のチケットを同時にオープンした期間がある場合は、重複期間をオープンしていたチケットの数で割って計算する。

例えば下記のような出力が得られる。
~~~
$ redmine clock
Clock during [2019/06/24, 2019-06-24T23:59:00+09:00)
246  1    project A          Task A-1
241  13   project A          Task A-2
276  94   project A          Task A-3
L9   259  private_project    private task
---  ---  ---                ---
     109  project A          // プロジェクトごとのクロック
     259  private_project
---  ---  ---                ---
     369  total              // 総クロック
~~~

引数なしの場合は今日のクロックを表示する。
引数が 1 つの場合は指定した日のクロックを表示する。
引数が 2 つの場合は指定した期間のクロックを表示する。
~~~
$ redmine clock                         // 今日のクロックの表示
$ redmine clock 2019/06/20              // 指定した日のクロックを表示
$ redmine clock 06/20 06/23             // 指定した期間のクロックを表示
$ redmine clock "a week ago" "today"    // date コマンドの -d オプションが認識する方法で入力可能
~~~

### open

指定したチケットをブラウザで表示する。

## データ構造

(現状結構ガバガバなので速度とか気になるようになったら改善していく予定)
